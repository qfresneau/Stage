======================================================================================================================
							AVRIL
======================================================================================================================

************
10/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (lecture et écriture) version 1.
Difficulté rencontrée : Framework (utilisation, définition...)

Solution : 
	Dossier librairie à mettre à la racine

************
11/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (lecture et écriture) version 1.
Problèmes rencontrés : fichier OPCConfigurationSection (lecture dans fichier xml)

Hypothèses : 
	- Problème de lien avec la Framework Fleury Michon ?
	- Problème venant de la configuration du fichier ?

Sources : 
	Compréhention de la communication via Client/Serveur OPC
http://hadiscada.blogspot.fr/2013/07/my-opc-client.html
https://www.faweb.net/us/opc/sample_vbnet.html

************
12/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 1.
Problèmes rencontrés : fonction OPCServer.connect() (connexion au serveur OPC)

Hypothèses : 
	- Problème de lien avec les différentes Frameworks utilisés ?
	- Problème d'initialisation de l'objet OPCServer ?

Solution : 
	Il suffisait d'instancier l'objet OPCServer (new), d'où l'erreur "La référence d'objet n'est pas définie à une instance d'un objet."

Sources : 
	Compréhention de la communication via Client/Serveur OPC
http://codes-sources.commentcamarche.net/forum/affich-1446285-probleme-avec-la-dll-opcdaauto-dll
http://codes-sources.commentcamarche.net/forum/affich-1616917-connexion-entre-un-api-elau-c600-et-un-pc-via-opc-server

************
13/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 1.
Problèmes rencontrés : fonctions SyncWrite et SyncRead (écriture et lecture)

Hypothèses : 
	- Différence à trouver entre les fonctions normales et les fonctions Sync.
	- Mauvais paramétrage du serveur OPC (Group puis Item) ?
	- Mauvais paramétrage de la fonction ?

Solution : 
	Utilisation de la fonction Write(Value) et Read(Source, Result).
	Result est une variable de type System.Int32, optimisation possible pour gérer tous les types.  

Sources : 
	Recherche dans le code existant avec les fichiers MesToTrk et ACQMoulageToMes.

************
14/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Difficulté rencontrée : Rendre le code plus orienté objet en copiant la structure existante.

Sources : 
	Recherche dans le code existant avec les fichiers MesToTrk et ACQMoulageToMes.
https://www.kepware.com/en-us/support/resource-library/technical-notes/canonical-data-types/

************
20/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Difficulté rencontrée : Connexion au serveur "APPLICOM.OPCServer.1" impossible.

Hypothèses : 
	- Maintenance de prévu sur le serveur ?
	- Trop de tentatives de connexion pendant le développement donc bloqués ? Connexion à un automate émulé donc normalement pas de risque.

Essais : 
	- Test de la version 1 de l'applicomDB1 (fonctionnel) --> impossible de se connecter.
	- Test de connexion avec le logiciel OPClient --> Non, l'application ne répond plus une fois la connexion lancée.
	- Arréter et relancer OPClient via le gestionnaire de tâche --> Non.

Solution : 
	Demande de relance du service --> OK.

************
21/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Problème rencontré : Paramétrage du serveur non pris en compte.

Hypothèses : 
	- Imports inutile et qui rentre en conflits (Tracer) ?

Essais : 
	- Essai sans les imports.

Solution : 
	Il manquait les Frameworks pour que les imports puissent être pris en compte.


----------------------------------------------------------------------------------------------------

Problème rencontré : Fonction add() ne fonctionne pas.

Hypothèses : 
	- La fonction peut-elle prendre un paramètre ? Normalement oui, un objet pour le Name.

Essais : 
	- Essai sans paramètres.
	- Essai en mode debug --> En mode debug, le programme est fonctionnel.

----------------------------------------------------------------------------------------------------

Problème rencontré : Ecriture et Lecture non fonctionnel.

Hypothèses : 
	- Imports inutile et qui rentre en conflits (Tracer) ?

Solution : 
	Problème venant de l'instanciation de l'objet GroupeOPC, il n'était pas fait donc l'écriture n'était pas possible.

Sources : 
	Recherches de solutions dans l'ensemble deS erreurs stockées sur le site de MSDN.
https://msdn.microsoft.com/fr-fr/library/af1y26ew(v=vs.80).aspx

************
25/04/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Communication entre l'automate Schneider et étiqueteuse non pris en charge. --> Recherche de solution par le responsable (Sébastien Marais).

Solution : 
	Communication réussi, tentative d'échange de trame simple en Zipher ASCII.

----------------------------------------------------------------------------------------------------

Problème rencontré : La communication OPC ne sera peut être pas utilisable avec le Schneider.

Essais : 
	- Recherche sur les sites officielles. --> La marque Schneider Electronics intervient dans les automates pris en charge par la communication OPC (Framework Automation).

Sources : 
	Dossier de spécifications générales de l'application MesToColis.
http://www.automation-sense.com/blog/automatisme/communication-pc-automate-avec-visual-basic-ou-c.html

************
26/04/2017 : 
************

Développement de l'application MesToColis.
Difficulté rencontrée : Recherche des différents paramètres et fonctions d'envoies à réaliser ou revoir sur l'application.

Sources : 
	Dossier de spécifications générales de l'application MesToColis.


======================================================================================================================
							MAI
======================================================================================================================

************
02/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Lancement de l'application MesToColis impossible sur le réseau / Ping du serveur du site MTT impossible.

Hypothèse : 
	- Problème de droits ? Non.
	- Version de l'application non stable ? Non.

Solution : 
	Fichier de connexion à la base de données incomplet, le programme se stoppait.
C:\Windows\System32\drivers\etc\hosts
D:\Oracle\ora11\network\admin\tnsnames.ora

----------------------------------------------------------------------------------------------------

Problème rencontré : Framework "log4net.dll" n'ont pris en charge alors qu'elle est bien dans le dossier C:\Windows\assembly.

Hypothèse :
	- Version antérieur donc non prise en charge ?

Solution : 
	Suppression et ajout du fichier avec une nouvelle référence.

Sources : 
https://msdn.microsoft.com/en-us/library/system.windows.markup.xamlparseexception(v=vs.110).aspx

************
03/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Deux configuration rentre en conflit (Core.Configuration et Configuration).

Hypothèse : 
	- La classe groupElement ne peut être utiliser que par une seule configuration ? Non, besoin de paramEtiq et paramOPC.
	- Problème de redirection ? --> Oui.

Solution : 
	Les deux fichiers de configuration sont dans des "Namespace" différents : (Core.Configuration et Configuration)

----------------------------------------------------------------------------------------------------

Problème rencontré : Test et débugage de l'application, arborescence du masque d'étiquette.

Hypothèse : 
	- Problème de lecture du masque ? Mauvais format ? Non.
	- Pas d'accès à la base de donnée PMT1 ? Non.
	- Problème d'arborescence du masque ? --> Surement.

Solution :
	Application mal paramétrée (dans le .config) puisque TypeTransfert doit être à "SERVICE" et le code machine doit être une des machine de TLM.
	Mauvaise compréhension du mode "SERVICE" --> à revoir /!\

************
04/05/2017 :
************

Tests et débugage de l'application MesToColis.
Problème rencontré : Conflits de class entre deux fichiers de configuration (OPCConfigurationSection et EtiqueteuseConfigurationSection)

Hypothèse : 
	- Possibilités de renommé le la variable groupeElement ? Impossible, elle fait partie d'une classe du système.
	- Changement de répertoire pour ne pas qu'elle rentre en conflit ? --> Oui.
	- Erreur venant des imports de l'application ? Non.

Solution : 
	Le fichier de configuration de l'application et de l'automate doivent être dans un dossier et celui des étiqueteuses dans un autre. (version 1)
	Le conflit venait des classes groupElement et groupCollection renommé respectivement en groupElements et groupCollections dans le fichiers de configuration de l'automate (OPCConfigurationSection). (version 2)

************
05/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Lors de l'initialisation de l'application, un seul masque doit être chargé.

Hypothèse : 
	- Nom du "fic" dans le "Directory.GetFiles" ne correspond pas avec celui spécifié dans les paramètres de l'application ? Oui, le nom du fichier est précédé aussi de son arborescence.
	- Ailleurs le programme recherche t'il des cohérances entre l'OF sélectionné et le masque sélectionné ? --> Oui il faudrait donc zapper cette étape avec le nouveau paramètre rajouté.
	- Le paramètre Recherche_PFF y est-il pour quelque chose ? Non, ce paramètre permet de rechercher la référence du code du produit fini (pour le site MTT).

Solution : 
	Deux changements sont à réaliser, un dans le ModelView.vb (à l'initialisation) et un dans le MainWindows.xaml.vb (à l'initialisation).

************
09/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Le masque d'étiquette par défaut ne s'affiche pas dans la combobox.

Hypothèse : 
	- Le masque d'étiquette est-il bien paramétrer ? Oui, on a tester avec un masque de MTT.
	- Le chemin parcouru des données du masque entre les différentes fonctions ne lance t'il pas dexceptions ? Non, test en mode débugage, les données du masque sont bien correctes. (/!\ code machine !!!)
	- La valeur de la combobox est-elle bien pris en compte ? Non, Fonction SelectedItem et SelectedValue de la combobox n'ont pas la même signification.

Solution : 
	Initialisation de la valeur selectionné de la combobox avec SelectedValue et passage au travers des différentes vérification et recherches de masques.

************
10/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Connexion avec l'automate de test basé sur TLM.

Hypothèse : 
	- L'automate n'a pas encore été mis sur le réseau de l'entreprise ? Surement .
	- L'automate est à configurer / ajouter sur le serveur Applicom ? 
	- La connexion OPC ne nous permet pas de nous connecter à l'automate ? 

Essais : 
	- Utilisation du logiciel PC Network Interface. --> L'automate 10.126.31.191 n'apparait pas dans la liste.
	- Ping de quelques adresses des automates visible sr le logiciel --> Le ping est bien reçu.

Solution : L'automate n'a pas pu être installé, donc il est bien configurer pour être accessible sur le réseau mais n'a pas été mis sous tension (à voir vendredi).

************
12/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Chargement d'un masque type pour TLM non géré (Videojet-1.xml), le programme plante.

Hypothèse : 
	- La structure xml (mapping) du masque n'est pas encore pris en compte ? Surement.
	- Certaines informations nécessaires à l'étiquetage ne sont pas présentes ? Oui le numéro du masque, la libelle du masque et le code machine.

Essais : 
	- Copie et modification d'un masque existant (101.xml) pour faire apparaitre les différentes informations du masque de TLM.

Solution : Les hypothèses émises confirment le problème (reste à revoir la différence entre masque d'UT et masque d'OF).

----------------------------------------------------------------------------------------------------

Problème rencontré : Tentative de ping l'automate de test, il n'est pas accessible.

Hypothèse : 
	- La prise Ethernet sur laquelle est branché l'automate n'est pas brassée ?
	- Problème de Firewall, port d'émission, port switch ?

Solution : Problème de passerelle et de masque lors du paramétrage de l'automate.


----------------------------------------------------------------------------------------------------

Problème rencontré : Envoi de données à l'automate, envoi possible mais jusqu'à une certaine taille des données.

Hypothèse : 
	- Fonction Write() qui ne peut pas géré autant de mémoire ? Non.
	- Problème de paramétrage des mots de l'automate ?

Essais: 
	- Pour les entiers : envoi de 1 --> OK, envoi de 10000 --> OK, envoi supérieur --> erreur.
	- Pour les chaines de caractères : envoi de "a" --> erreur.
	- Envoi de la longueur d'une valeur à envoyer avant de l'envoyer --> erreur lors de l'envoi de la valeur.

Solution : 


======================================================================================================================
							JUIN
======================================================================================================================



======================================================================================================================
							JULLET
======================================================================================================================

