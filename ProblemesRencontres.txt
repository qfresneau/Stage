======================================================================================================================
							AVRIL
======================================================================================================================

************
10/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (lecture et écriture) version 1.
Difficulté rencontrée : Framework (utilisation, définition...)

Solution : 
	Dossier librairie à mettre à la racine

************
11/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (lecture et écriture) version 1.
Problèmes rencontrés : fichier OPCConfigurationSection (lecture dans fichier xml)

Hypothèses : 
	- Problème de lien avec la Framework Fleury Michon ?
	- Problème venant de la configuration du fichier ?

Sources : 
	Compréhention de la communication via Client/Serveur OPC
http://hadiscada.blogspot.fr/2013/07/my-opc-client.html
https://www.faweb.net/us/opc/sample_vbnet.html

************
12/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 1.
Problèmes rencontrés : fonction OPCServer.connect() (connexion au serveur OPC)

Hypothèses : 
	- Problème de lien avec les différentes Frameworks utilisés ?
	- Problème d'initialisation de l'objet OPCServer ?

Solution : 
	Il suffisait d'instancier l'objet OPCServer (new), d'où l'erreur "La référence d'objet n'est pas définie à une instance d'un objet."

Sources : 
	Compréhention de la communication via Client/Serveur OPC
http://codes-sources.commentcamarche.net/forum/affich-1446285-probleme-avec-la-dll-opcdaauto-dll
http://codes-sources.commentcamarche.net/forum/affich-1616917-connexion-entre-un-api-elau-c600-et-un-pc-via-opc-server

************
13/04/2017 : 
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 1.
Problèmes rencontrés : fonctions SyncWrite et SyncRead (écriture et lecture)

Hypothèses : 
	- Différence à trouver entre les fonctions normales et les fonctions Sync.
	- Mauvais paramétrage du serveur OPC (Group puis Item) ?
	- Mauvais paramétrage de la fonction ?

Solution : 
	Utilisation de la fonction Write(Value) et Read(Source, Result).
	Result est une variable de type System.Int32, optimisation possible pour gérer tous les types.  

Sources : 
	Recherche dans le code existant avec les fichiers MesToTrk et ACQMoulageToMes.

************
14/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Difficulté rencontrée : Rendre le code plus orienté objet en copiant la structure existante.

Sources : 
	Recherche dans le code existant avec les fichiers MesToTrk et ACQMoulageToMes.
https://www.kepware.com/en-us/support/resource-library/technical-notes/canonical-data-types/

************
20/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Difficulté rencontrée : Connexion au serveur "APPLICOM.OPCServer.1" impossible.

Hypothèses : 
	- Maintenance de prévu sur le serveur ?
	- Trop de tentatives de connexion pendant le développement donc bloqués ? Connexion à un automate émulé donc normalement pas de risque.

Essais : 
	- Test de la version 1 de l'applicomDB1 (fonctionnel) --> impossible de se connecter.
	- Test de connexion avec le logiciel OPClient --> Non, l'application ne répond plus une fois la connexion lancée.
	- Arréter et relancer OPClient via le gestionnaire de tâche --> Non.

Solution : 
	Demande de relance du service --> OK.

************
21/04/2017 :
************

Développement d'une application de communication entre logiciel et automate DB1 (connexion, lecture et écriture) version 2.
Problème rencontré : Paramétrage du serveur non pris en compte.

Hypothèses : 
	- Imports inutile et qui rentre en conflits (Tracer) ?

Essais : 
	- Essai sans les imports.

Solution : 
	Il manquait les Frameworks pour que les imports puissent être pris en compte.


----------------------------------------------------------------------------------------------------

Problème rencontré : Fonction add() ne fonctionne pas.

Hypothèses : 
	- La fonction peut-elle prendre un paramètre ? Normalement oui, un objet pour le Name.

Essais : 
	- Essai sans paramètres.
	- Essai en mode debug --> En mode debug, le programme est fonctionnel.

----------------------------------------------------------------------------------------------------

Problème rencontré : Ecriture et Lecture non fonctionnel.

Hypothèses : 
	- Imports inutile et qui rentre en conflits (Tracer) ?

Solution : 
	Problème venant de l'instanciation de l'objet GroupeOPC, il n'était pas fait donc l'écriture n'était pas possible.

Sources : 
	Recherches de solutions dans l'ensemble deS erreurs stockées sur le site de MSDN.
https://msdn.microsoft.com/fr-fr/library/af1y26ew(v=vs.80).aspx

************
25/04/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Communication entre l'automate Schneider et étiqueteuse non pris en charge. --> Recherche de solution par le responsable (Sébastien Marais).

Solution : 
	Communication réussi, tentative d'échange de trame simple en Zipher ASCII.

----------------------------------------------------------------------------------------------------

Problème rencontré : La communication OPC ne sera peut être pas utilisable avec le Schneider.

Essais : 
	- Recherche sur les sites officielles. --> La marque Schneider Electronics intervient dans les automates pris en charge par la communication OPC (Framework Automation).

Sources : 
	Dossier de spécifications générales de l'application MesToColis.
http://www.automation-sense.com/blog/automatisme/communication-pc-automate-avec-visual-basic-ou-c.html

************
26/04/2017 : 
************

Développement de l'application MesToColis.
Difficulté rencontrée : Recherche des différents paramètres et fonctions d'envoies à réaliser ou revoir sur l'application.

Sources : 
	Dossier de spécifications générales de l'application MesToColis.


======================================================================================================================
							MAI
======================================================================================================================

************
02/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Lancement de l'application MesToColis impossible sur le réseau / Ping du serveur du site MTT impossible.

Hypothèse : 
	- Problème de droits ? Non.
	- Version de l'application non stable ? Non.

Solution : 
	Fichier de connexion à la base de données incomplet, le programme se stoppait.
C:\Windows\System32\drivers\etc\hosts
D:\Oracle\ora11\network\admin\tnsnames.ora

----------------------------------------------------------------------------------------------------

Problème rencontré : Framework "log4net.dll" n'ont pris en charge alors qu'elle est bien dans le dossier C:\Windows\assembly.

Hypothèse :
	- Version antérieur donc non prise en charge ?

Solution : 
	Suppression et ajout du fichier avec une nouvelle référence.

Sources : 
https://msdn.microsoft.com/en-us/library/system.windows.markup.xamlparseexception(v=vs.110).aspx

************
03/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Deux configuration rentre en conflit (Core.Configuration et Configuration).

Hypothèse : 
	- La classe groupElement ne peut être utiliser que par une seule configuration ? Non, besoin de paramEtiq et paramOPC.
	- Problème de redirection ? --> Oui.

Solution : 
	Les deux fichiers de configuration sont dans des "Namespace" différents : (Core.Configuration et Configuration)

----------------------------------------------------------------------------------------------------

Problème rencontré : Test et débugage de l'application, arborescence du masque d'étiquette.

Hypothèse : 
	- Problème de lecture du masque ? Mauvais format ? Non.
	- Pas d'accès à la base de donnée PMT1 ? Non.
	- Problème d'arborescence du masque ? --> Surement.

Solution :
	Application mal paramétrée (dans le .config) puisque TypeTransfert doit être à "SERVICE" et le code machine doit être une des machine de TLM.
	Mauvaise compréhension du mode "SERVICE" --> à revoir /!\

************
04/05/2017 :
************

Tests et débugage de l'application MesToColis.
Problème rencontré : Conflits de class entre deux fichiers de configuration (OPCConfigurationSection et EtiqueteuseConfigurationSection)

Hypothèse : 
	- Possibilités de renommé le la variable groupeElement ? Impossible, elle fait partie d'une classe du système.
	- Changement de répertoire pour ne pas qu'elle rentre en conflit ? --> Oui.
	- Erreur venant des imports de l'application ? Non.

Solution : 
	Le fichier de configuration de l'application et de l'automate doivent être dans un dossier et celui des étiqueteuses dans un autre. (version 1)
	Le conflit venait des classes groupElement et groupCollection renommé respectivement en groupElements et groupCollections dans le fichiers de configuration de l'automate (OPCConfigurationSection). (version 2)

************
05/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Lors de l'initialisation de l'application, un seul masque doit être chargé.

Hypothèse : 
	- Nom du "fic" dans le "Directory.GetFiles" ne correspond pas avec celui spécifié dans les paramètres de l'application ? Oui, le nom du fichier est précédé aussi de son arborescence.
	- Ailleurs le programme recherche t'il des cohérances entre l'OF sélectionné et le masque sélectionné ? --> Oui il faudrait donc zapper cette étape avec le nouveau paramètre rajouté.
	- Le paramètre Recherche_PFF y est-il pour quelque chose ? Non, ce paramètre permet de rechercher la référence du code du produit fini (pour le site MTT).

Solution : 
	Deux changements sont à réaliser, un dans le ModelView.vb (à l'initialisation) et un dans le MainWindows.xaml.vb (à l'initialisation).

************
09/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Le masque d'étiquette par défaut ne s'affiche pas dans la combobox.

Hypothèse : 
	- Le masque d'étiquette est-il bien paramétrer ? Oui, on a tester avec un masque de MTT.
	- Le chemin parcouru des données du masque entre les différentes fonctions ne lance t'il pas dexceptions ? Non, test en mode débugage, les données du masque sont bien correctes. (/!\ code machine !!!)
	- La valeur de la combobox est-elle bien pris en compte ? Non, Fonction SelectedItem et SelectedValue de la combobox n'ont pas la même signification.

Solution : 
	Initialisation de la valeur selectionné de la combobox avec SelectedValue et passage au travers des différentes vérification et recherches de masques.

************
10/05/2017 :
************

Développement de l'application MesToColis.
Problème rencontré : Connexion avec l'automate de test basé sur TLM.

Hypothèse : 
	- L'automate n'a pas encore été mis sur le réseau de l'entreprise ? Surement .
	- L'automate est à configurer / ajouter sur le serveur Applicom ? 
	- La connexion OPC ne nous permet pas de nous connecter à l'automate ? 

Essais : 
	- Utilisation du logiciel PC Network Interface. --> L'automate 10.126.31.191 n'apparait pas dans la liste.
	- Ping de quelques adresses des automates visible sr le logiciel --> Le ping est bien reçu.

Solution : L'automate n'a pas pu être installé, donc il est bien configurer pour être accessible sur le réseau mais n'a pas été mis sous tension (à voir vendredi).

************
12/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Chargement d'un masque type pour TLM non géré (Videojet-1.xml), le programme plante.

Hypothèse : 
	- La structure xml (mapping) du masque n'est pas encore pris en compte ? Surement.
	- Certaines informations nécessaires à l'étiquetage ne sont pas présentes ? Oui le numéro du masque, la libelle du masque et le code machine.

Essais : 
	- Copie et modification d'un masque existant (101.xml) pour faire apparaitre les différentes informations du masque de TLM.

Solution : Les hypothèses émises confirment le problème (reste à revoir la différence entre masque d'UT et masque d'OF).

----------------------------------------------------------------------------------------------------

Problème rencontré : Tentative de ping l'automate de test, il n'est pas accessible.

Hypothèse : 
	- La prise Ethernet sur laquelle est branché l'automate n'est pas brassée ?
	- Problème de Firewall, port d'émission, port switch ?

Solution : Problème de passerelle et de masque lors du paramétrage de l'automate.


----------------------------------------------------------------------------------------------------

Problème rencontré : Envoi de données à l'automate, envoi possible mais jusqu'à une certaine taille des données.

Hypothèse : 
	- Fonction Write() qui ne peut pas géré autant de mémoire ? Non.
	- Problème de paramétrage des mots de l'automate ?

Essais: 
	- Pour les entiers : envoi de 1 --> OK, envoi de 10000 --> OK, envoi supérieur --> erreur.
	- Pour les chaines de caractères : envoi de "a" --> erreur.
	- Envoi de la longueur d'une valeur à envoyer avant de l'envoyer --> erreur lors de l'envoi de la valeur.

Solution : Les informations à envoyer doivent être écritent sur plusieurs mots de l'automate (un caractère pour un mot).
https://msdn.microsoft.com/en-us/library/cc704587.aspx

************
15/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Envoi de données à l'automate, l'adresse d'un item n'est pas reconnue.

Hypothèse : 
	- L'adresse n'est pas au bon format ? Si, déjà utilisé des adresses similaires avec l'application MesToTrk.
	- Problème venant de l'automate ? Surement.

Essais : 
	- Ajout d'un item avec le logiciel OPClient --> Adresse %MW5020:X01 non reconnu.
	- Ajout d'un item avec le logiciel OPClient --> Adresse %MW5020:X1 reconnu.

Solution : Le problème venait juste de l'adresse du mot, il ne fallait qu'un seul chiffre après le X.

************
16/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Freeze du programme lorsqu'on envoi les données.

Hypothèse : 
	- Toute l'initialisation et la connexion au serveur OPC se fait en même temps donc c'est peut-être la cause du ralentissement ? Non.

Solution : Une ligne de code oubliée lors des périodes de tests (System.Threading.Threads.sleep(1000)) ce qui provoquait une pause de 1 secondes lorsqu'un groupe était ajouté.

----------------------------------------------------------------------------------------------------

Problème rencontré : Envoi du numéros d'OF impossible, le nombre est trop grand.

Hypothèse : 
	- Les mots des automates sont peut-être signé ? Oui.

Essais : 
	- Envoi d'un nombre caractère par caractère puis entier --> Envoi de 800000, il affiche 59.

Solution : Changement de l'adresse du mot, on utilise maintenant le mot %MD5000 qui n'est pas signé donc beaucoup plus de mémoire.

************
17/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Les valeurs, une fois modifiées, ne sont pas toutes vérifiées et l'affichage d'erreur ne se fait pas.

Hypothèse : 
	- La table contenant les expréssions régulières contient-elle uneligne pour chacuns des paramètres du masque ? Non.
	- L'utilisateur aura t'il à modifier les valeurs qui seront préchargées avec le masque ? Peut-être pas.
	- Modifications des droits d'accès aux bouton Modifier et Enregistrer ?

Essais : 
	- Observation de la table USER_PRM_CTRL de PRODUCIM pour voir les différentes expréssions régulières qui existent --> Seulement 8, pas de CAGETTE.

Solution : S'il n'existe pas d'expréssions régulières pour certains paramètres, on ne vérifie pas.

----------------------------------------------------------------------------------------------------

Problème rencontré : Le code #CAGETTE# présent dans le fichier xml envoyé à iDaro n'est pas reconnu.

Hypothèse : 
	- Le code #CAGETTE# n'éxiste pas (ou renommé) dans les bases de données donc impossible de trouvé le libellé ainsi que la valeur ? Surement.
	- La valeur du code #CAGETTE# est-elle reçu d'un automate ? Non, elle est présente avec l'ensemble des informations d'un modelOf.
	- La requête SQL permet-elle d'extraire cette information ? Oui.

Essais : 
	- Utilisation de SQL Developper pour trouver le paramètre --> Pas de code carton trouvé.
	- Affichage de toutes les variable de l'objet de classe ModelOf et Of --> Pas de code carton trouvé (400000).

Solution : Le paramètre RecherchePFF doit être à "OUI" pour pouvoir chargé les information de l'OF ou de l'UT.

************
19/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Alors que l'automate est débranché, certaines fonctionnalités (lorsqu'il est branché) se lancent.

Hypothèse : 
	- Problème de la gestion d'erreur lors de l'initialisation des paramètres et de la communication avec l'automate ? Oui.

Essais : 
	- Mise en place d'une fonction TestCo() --> Utilisation d'un mauvais paramètre.

Solution : Lors de l'initialisation, j'utilisais la variable OPC.isconnected (coté serveur) alors que je devais utiliser la variable OPC_INIT à vrai ou faux en fonction du résultat de l'initialisation.

************
22/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Lors du chargement des informations, le lot UVC est la seule donnée qui n'est pas chargée.

Hypothèse : 
	- Le lot UVC doit-il être toujours lu ? Non, seulement en mode UT. En mode OF, il est entré par l'utilisateur.
	- Quelle est la différence entre le Code_Machine et l'ID_Machine ?

Essais : 
	- Test en mode UT (022104170158003) avec une version antérieur de MesToColis sur TLM --> Il est bien chargé.
	- Test en mode OF --> L'information est manquante.
	- Utilisation de la fonction dynamique --> La fonction ne fonctionne pas avec le site TLM (ID_Machine manquant)

Solution : La fonction utilisé auparavant charge bien le lot UVC en mode UT et il doit être entré par l'utilisateur en mode OF.

----------------------------------------------------------------------------------------------------

Problème rencontré : Le numéro d'OF n'apparait pas en mode OF, l'envoi ne se fait pas.

Hypothèse : 
	- En mode UT, y a t'il un numéro d'OF ? Non.
	- La différence entre la valeur de la variable ModOF.NumActi en mode OF et en mode UT ?

Essais : 
	- Affichage de la valeurs dans les deux mode --> mode OF : code 800000 (correct), mode UT : code correspondant à l'UT entrée.

Solution : En mode OF, le numéros d'OF éxiste bien mais en mode UT, il n't a pas de numéros d'OF.

************
24/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Lors du lancement de l'application, crash de celle-ci.

Hypothèse : 
	- Modification apporté qui ne convient pas ? Non, modifications faites uniquement dans le cas où l'automate n'est pas joignable.
	- Problème de compilation ? Oui, l'erreur provennait du fichier Application.g.vb.
	- Problème de lien entre les fichiers ? Peut être, avec les frameworks etc.
	- Fichier Application.g.vb modifié de l'extérieur, chargement de celui-ci ? Oui/Non, rien ne change.

Essais : 
	- Test en débugage sur la première ligne lancée dans le programme (création d'un objet avec New()) --> Celle-ci ne se lance même pas donc le problème vient du chargement des fichiers extérieurs.
	- Suppression et rechargement de certaines Framework tel que log4net.dll, OPCAutomation.dll et PresentationFramework --> Rien n'a changé mais le problème est lié à PresentationFramework.dll.

Solution : Cause du problème encore inconnue, mais il provenait du fichier Application.g.vb. Il a suffit de le supprimer et de relancer une génération de solution pour que le fichier puisse être recréé.


************
29/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Lors da connexion à l'automate, affichage d'une erreur en relation avec l'ajout d'item.

Hypothèse : 
	- Modification apporté qui ne convient pas ? Surement.
	- Problème de mémoire entre les tests ? Non, chaque communication (même en cas d'erreur) se termine par stopOPC() avec une libération de la mémoire.
	- Fonction addItems qui ne supportent pas l'ajout d'autant d'items ? Non, elle fonctionnait bien avant.

Essais : 
	- Lecture d'une documentation OPCFundation --> La fonction AddItems peut ne pas correctement fonctrionner si le groupe spécifié est déjà actif.
	- Chargement du fichier ImportOPCManager.vb fonctionnel (sauvegarde) --> OK.

Solution : Cause du problème venant d'une erreur d'inatention sur le fichier ImportOPCManager.

************
31/05/2017 : 
************

Développement de l'application MesToColis.
Problème rencontré : Lors de l'envoi de la donnée code carton (6 caractères), l'automate affiche qu'il y a 7 caractères.

Hypothèse : 
	- Erreur d'adressage ? Surement.
	- La valeur envoyé est plus grande que prévu ? Non.
	- La valeur envoyer n'est pas la bonne ? Non.

Essais : 
	- Affichage avant envoi du nombre de caractère de l'information et de sa valeur --> Ils correspondent bien.
	- Relecture de l'adressage vers l'automate --> Erreur de frappe, l'adresse du flag pour la ligne 99 était %MW5025:X0 et pour la ligne 98 %MW5024:X0 alors qu'elles doivent toutes les deux égales à %MW5024:X0.

Solution : Erreur de frappe en tapant la documentation sur l'adressage de l'automate.

----------------------------------------------------------------------------------------------------

Problème rencontré : Lors de la compilation du programme, celui-ci crash.

Hypothèse : 
	- Modification apporté qui ne convient pas ? Surement.
	- Problème de mémoire sur le serveur ? Peut-être, expliquerais aussi les problèmes rencontrer quelques fois avec l'initialisation du client et serveur OPC.

Essais : 
	- Suppression des modifications --> Pas mieux, le programme ne remarque plus la framework OPCAuto.dll (Automation).
	- Contact avec Pierrick Réau pour plus d'information --> Coïncidence avec les modifications apporté, l'espace disque sur le C et le E sont insufisant ou vont bientôt l'être.

Solution : Problème de mémoire causé par les fichiers tempon créé par le programme.

======================================================================================================================
							JUIN
======================================================================================================================

************
02/06/2017 : 
************

Développement de l'application MesToColis.
Difficulté rencontrée : Identification lors de l'installation de la nouvelle version de l'application sur le serveur de test.

Hypothèse : 
	- "Utilisateur non reconnu" Pas le même nom d'utilisateur sur les différent serveur ? Surement.

Essais : 
	- Demande auprès de M. µRéau Pierrick afin de changer mon nom d'utilisateur sur les différents serveur --> fresneau.q en fresneau.adm

Solution : Les hypothèses émises confirment le problème (authentification avec différen nom d'utilisateur).

----------------------------------------------------------------------------------------------------

Problème rencontré : 

Hypothèse : 
	- 

Essais : 
	- 

Solution : 

======================================================================================================================
							JULLET
======================================================================================================================

